local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")

local CustomLib = {}
CustomLib.__index = CustomLib

local function createElement(class, properties)
	local element = Instance.new(class)
	for prop, val in pairs(properties) do
		element[prop] = val
	end
	return element
end

function CustomLib:CreateWindow(config)
	local screenGui = createElement("ScreenGui", {
		Name = "CustomLib",
		ResetOnSpawn = false,
		ZIndexBehavior = Enum.ZIndexBehavior.Sibling,
		Parent = game.CoreGui
	})

	local dragFrame = createElement("Frame", {
		Name = "DragFrame",
		Size = UDim2.new(0, 500, 0, 300),
		Position = UDim2.new(0.5, -250, 0.5, -150),
		BackgroundTransparency = 0.3,
		BackgroundColor3 = Color3.fromRGB(30, 30, 30),
		Active = true,
		Draggable = true,
		Parent = screenGui
	})

	local uiCorner = Instance.new("UICorner", dragFrame)
	uiCorner.CornerRadius = UDim.new(0, 12)

	local titleLabel = createElement("TextLabel", {
		Text = config.Title or "Custom UI",
		Size = UDim2.new(1, 0, 0, 40),
		BackgroundTransparency = 1,
		TextColor3 = Color3.new(1, 1, 1),
		Font = Enum.Font.GothamBold,
		TextScaled = true,
		Parent = dragFrame
	})

	local tabHolder = createElement("Frame", {
		Name = "TabHolder",
		Size = UDim2.new(0, 120, 1, -40),
		Position = UDim2.new(0, 0, 0, 40),
		BackgroundTransparency = 0.4,
		BackgroundColor3 = Color3.fromRGB(20, 20, 20),
		Parent = dragFrame
	})

	createElement("UICorner", {CornerRadius = UDim.new(0, 8), Parent = tabHolder})

	local contentHolder = createElement("Frame", {
		Name = "ContentHolder",
		Size = UDim2.new(1, -120, 1, -40),
		Position = UDim2.new(0, 120, 0, 40),
		BackgroundTransparency = 0.5,
		BackgroundColor3 = Color3.fromRGB(25, 25, 25),
		Parent = dragFrame
	})

	createElement("UICorner", {CornerRadius = UDim.new(0, 8), Parent = contentHolder})

	local tabs = {}

	function CustomLib:CreateTab(tabName)
	
	local buttonHolder = createElement("Frame", {
	Size = UDim2.new(1, -10, 0, 30),
	Position = UDim2.new(0, 5, 0, (#tabs * 35)),
	BackgroundTransparency = 1,
	Parent = tabHolder
})

local button = createElement("TextButton", {
	Text = tabName,
	Size = UDim2.new(1, 0, 1, 0),
	BackgroundColor3 = Color3.fromRGB(50, 50, 50),
	TextColor3 = Color3.new(1,1,1),
	Font = Enum.Font.Gotham,
	TextScaled = true,
	Parent = buttonHolder
})
createElement("UICorner", {CornerRadius = UDim.new(0, 6), Parent = button})

local selectedLine = createElement("Frame", {
	Size = UDim2.new(1, 0, 0, 2),
	Position = UDim2.new(0, 0, 1, -2),
	BackgroundColor3 = Color3.fromRGB(0, 170, 255),
	Visible = (#tabs == 0),
	Parent = buttonHolder
})

		createElement("UICorner", {CornerRadius = UDim.new(0, 6), Parent = button})

		local tabFrame = createElement("Frame", {
			Name = tabName,
			Size = UDim2.new(1, 0, 1, 0),
			Visible = #tabs == 0,
			BackgroundTransparency = 1,
			Parent = contentHolder
		})

		local uiList = Instance.new("UIListLayout", tabFrame)
		uiList.Padding = UDim.new(0, 6)

		button.MouseButton1Click:Connect(function()
			for _, v in pairs(contentHolder:GetChildren()) do
				if v:IsA("Frame") then v.Visible = false end
			end
			tabFrame.Visible = true
		end)

		local tab = {}

		function tab:AddButton(text, callback)
			local btn = createElement("TextButton", {
				Text = text,
				Size = UDim2.new(1, -10, 0, 30),
				BackgroundColor3 = Color3.fromRGB(70, 70, 70),
				TextColor3 = Color3.new(1, 1, 1),
				Font = Enum.Font.Gotham,
				TextScaled = true,
				Parent = tabFrame
			})
			createElement("UICorner", {CornerRadius = UDim.new(0, 6), Parent = btn})
			btn.MouseButton1Click:Connect(callback)
		end

		function tab:AddToggle(text, callback)
			local toggle = createElement("TextButton", {
				Text = "[ OFF ] "..text,
				Size = UDim2.new(1, -10, 0, 30),
				BackgroundColor3 = Color3.fromRGB(70, 70, 70),
				TextColor3 = Color3.new(1, 1, 1),
				Font = Enum.Font.Gotham,
				TextScaled = true,
				Parent = tabFrame
			})
			createElement("UICorner", {CornerRadius = UDim.new(0, 6), Parent = toggle})

			local state = false
			toggle.MouseButton1Click:Connect(function()
				state = not state
				toggle.Text = (state and "[ ON ] " or "[ OFF ] ")..text
				callback(state)
			end)
		end

		function tab:AddTextbox(placeholder, callback)
			local textBox = createElement("TextBox", {
				PlaceholderText = placeholder,
				Size = UDim2.new(1, -10, 0, 30),
				BackgroundColor3 = Color3.fromRGB(80, 80, 80),
				TextColor3 = Color3.new(1, 1, 1),
				Font = Enum.Font.Gotham,
				TextScaled = true,
				ClearTextOnFocus = false,
				Parent = tabFrame
			})
			createElement("UICorner", {CornerRadius = UDim.new(0, 6), Parent = textBox})

			textBox.FocusLost:Connect(function()
				callback(textBox.Text)
			end)
		end

		function tab:AddDropdown(options, callback)
			local dropdown = createElement("TextButton", {
				Text = "Select",
				Size = UDim2.new(1, -10, 0, 30),
				BackgroundColor3 = Color3.fromRGB(80, 80, 80),
				TextColor3 = Color3.new(1,1,1),
				Font = Enum.Font.Gotham,
				TextScaled = true,
				Parent = tabFrame
			})
			createElement("UICorner", {CornerRadius = UDim.new(0, 6), Parent = dropdown})

			local menu = createElement("Frame", {
				Size = UDim2.new(1, -10, 0, #options*30),
				BackgroundColor3 = Color3.fromRGB(90, 90, 90),
				Visible = false,
				Parent = tabFrame
			})
			createElement("UICorner", {CornerRadius = UDim.new(0, 6), Parent = menu})

			local layout = Instance.new("UIListLayout", menu)

			for _, opt in ipairs(options) do
				local optBtn = createElement("TextButton", {
					Text = opt,
					Size = UDim2.new(1, 0, 0, 30),
					BackgroundColor3 = Color3.fromRGB(100, 100, 100),
					TextColor3 = Color3.new(1,1,1),
					Font = Enum.Font.Gotham,
					TextScaled = true,
					Parent = menu
				})
				createElement("UICorner", {CornerRadius = UDim.new(0, 6), Parent = optBtn})
				optBtn.MouseButton1Click:Connect(function()
					dropdown.Text = opt
					menu.Visible = false
					callback(opt)
				end)
			end

			dropdown.MouseButton1Click:Connect(function()
				menu.Visible = not menu.Visible
			end)
		end

		table.insert(tabs, tab)
		return tab
	end

	return CustomLib
end

return CustomLib
